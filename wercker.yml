box: wercker/ruby
no-response-timeout: 10
platform: ubuntu@14.04
build:
  steps:
    - bundle-install
    - install-packages:
        packages: wget unzip
    - script:
        name: install packer
        cwd: packer/
        code: |
          wget https://dl.bintray.com/mitchellh/packer/packer_0.7.5_linux_amd64.zip
          unzip packer_0.7.5_linux_amd64.zip
          ./packer version
    - script:
        cwd: packer/
        name: validate lb packer template
        code: ./packer validate lb_ubuntu-14-04_amd64.json
    - script:
        cwd: packer/
        name: validate mesos packer template
        code: ./packer validate mesos_ubuntu-14-04_amd64.json
    - script:
        name: build mesos image
        cwd: packer/
        code: |
          ./packer build mesos_ubuntu-14.04_amd64-amis.json
    - script:
        name: build lb image
        cwd: packer/
        code: |
          ./packer build lb_ubuntu-14.04_amd64-amis.json